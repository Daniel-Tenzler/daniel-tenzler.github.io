import{j as e}from"./emotion-element-f0de968e.browser.esm.D62_ulK7.js";import{r as t}from"./index.CxjelfC8.js";import{c as r}from"./emotion-styled-base.browser.esm.g6PGPNHA.js";import{C as a}from"./Colors.DSKoPjbV.js";const o=r("div",{target:"e19jlw9d17"})({name:"1i0tsdi",styles:"width:90%;max-width:1600px;height:100%;min-height:calc(100vh - 205px);margin:0 auto;padding:1.5em 0;display:flex;flex-direction:column;align-items:center;gap:1.5em"}),i=r("label",{target:"e19jlw9d16"})("color:",a.WHITE_BFBFBF,";font-size:1.1rem;font-weight:500;cursor:pointer;padding:0.75em 2em;border:2px solid ",a.GRAY_383838,";border-radius:8px;background-color:",a.GRAY_474747,";transition:all 0.2s ease;display:inline-block;text-align:center;min-width:200px;&:hover{background-color:",a.GRAY_383838,";border-color:",a.WHITE_BFBFBF,";}&:focus-within{outline:2px solid ",a.WHITE_BFBFBF,";outline-offset:2px;}@media (max-width: 480px){font-size:1rem;padding:0.6em 1.5em;min-width:150px;}"),s=r("input",{target:"e19jlw9d15"})({name:"eivff4",styles:"display:none"}),n=r("div",{target:"e19jlw9d14"})({name:"1vq371o",styles:"display:flex;justify-content:center;align-items:center;flex-direction:column;max-width:100%;margin:1em 0"}),l=r("img",{target:"e19jlw9d13"})("max-width:100%;max-height:300px;border-radius:8px;border:2px solid ",a.GRAY_383838,";box-shadow:0 4px 8px rgba(0, 0, 0, 0.2);@media (max-width: 768px){max-height:200px;}"),d=r("div",{target:"e19jlw9d12"})({name:"1y46tv2",styles:"display:flex;justify-content:center;align-items:center;gap:1.5em;flex-wrap:wrap;@media (max-width: 480px){gap:1em;}"}),c=r(r("button",{target:"e19jlw9d11"})("color:",a.WHITE_BFBFBF,";padding:0.75em 2em;border:none;border-radius:8px;background-color:",a.GRAY_2D2D2D,";font-weight:500;font-size:0.95rem;cursor:pointer;min-width:140px;transition:background-color 0.2s ease,box-shadow 0.2s ease;&:hover:not(:disabled){background-color:",a.GRAY_222939,";box-shadow:0 2px 4px rgba(0, 0, 0, 0.1);}&:active:not(:disabled){background-color:",a.GRAY_383838,";box-shadow:none;}&:focus-visible{outline:2px solid ",a.GRAY_222939,";outline-offset:2px;}&:disabled{opacity:0.5;cursor:not-allowed;}@media (max-width: 480px){padding:0.6em 1.5em;font-size:0.9rem;min-width:120px;}"),{target:"e19jlw9d10"})(""),m=r("div",{target:"e19jlw9d8"})({name:"h69x97",styles:"color:#ff6b6b;background-color:rgba(255, 107, 107, 0.1);border:1px solid rgba(255, 107, 107, 0.3);border-radius:6px;padding:0.75em 1em;margin:0.5em auto;text-align:center;font-size:0.9rem;max-width:90%"}),g=r("div",{target:"e19jlw9d7"})({name:"1cb0n2x",styles:"display:flex;flex-direction:column;gap:2em;width:100%;max-width:1500px;@media (min-width: 768px){flex-direction:row;justify-content:space-around;align-items:flex-start;}"}),h=r("div",{target:"e19jlw9d6"})("display:flex;justify-content:center;align-items:center;max-width:100%;canvas{max-width:100%;max-height:300px;border-radius:8px;border:2px solid ",a.GRAY_383838,";box-shadow:0 4px 8px rgba(0, 0, 0, 0.2);@media (max-width: 768px){max-height:200px;}}"),x=r("div",{target:"e19jlw9d5"})("display:flex;flex-direction:column;align-items:center;gap:1em;padding:1em;background-color:",a.GRAY_474747,";border-radius:8px;border:1px solid ",a.GRAY_383838,";max-width:400px;margin-left:auto;margin-right:auto;"),p=r("label",{target:"e19jlw9d4"})("color:",a.WHITE_BFBFBF,";font-size:1rem;font-weight:500;text-align:center;"),u=r("input",{target:"e19jlw9d3"})("width:100%;height:6px;border-radius:3px;background:",a.GRAY_383838,";outline:none;cursor:pointer;&::-webkit-slider-thumb{appearance:none;width:20px;height:20px;border-radius:50%;background:",a.WHITE_BFBFBF,";cursor:pointer;border:2px solid ",a.GRAY_383838,";transition:all 0.2s ease;&:hover{background:",a.WHITE_FFFFFF,";transform:scale(1.1);}}&::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:",a.WHITE_BFBFBF,";cursor:pointer;border:2px solid ",a.GRAY_383838,";transition:all 0.2s ease;&:hover{background:",a.WHITE_FFFFFF,";transform:scale(1.1);}}&:focus-visible{outline:2px solid ",a.WHITE_BFBFBF,";outline-offset:2px;}"),f=r("div",{target:"e19jlw9d2"})("display:flex;flex-direction:column;align-items:center;gap:1em;padding:1em;background-color:",a.GRAY_474747,";border-radius:8px;border:1px solid ",a.GRAY_383838,";max-width:400px;margin-left:auto;margin-right:auto;"),b=r("label",{target:"e19jlw9d1"})("color:",a.WHITE_BFBFBF,";font-size:1rem;font-weight:500;text-align:center;"),w=r("select",{target:"e19jlw9d0"})("background-color:",a.GRAY_383838,";color:",a.WHITE_BFBFBF,";border:2px solid ",a.GRAY_383838,";border-radius:6px;padding:0.5em 1em;font-size:0.95rem;cursor:pointer;min-width:200px;transition:all 0.2s ease;&:hover{border-color:",a.WHITE_BFBFBF,";}&:focus-visible{outline:2px solid ",a.WHITE_BFBFBF,";outline-offset:2px;border-color:",a.WHITE_BFBFBF,";}option{background-color:",a.GRAY_383838,";color:",a.WHITE_BFBFBF,";}"),F=()=>{const{selectedFile:r,imagePreview:a,rgbMatrix:F,error:j,isProcessing:B,smoothingFactor:v,smoothedMatrix:y,processingMode:I,fileInputRef:_,canvasRef:R,setSelectedFile:S,setImagePreview:M,setRgbMatrix:A,setIsProcessing:E,setSmoothingFactor:G,setSmoothedMatrix:k,setProcessingMode:Y,clearAll:P,setErrorState:T,clearError:W}=(()=>{const[e,r]=t.useState(null),[a,o]=t.useState(null),[i,s]=t.useState(""),[n,l]=t.useState(""),[d,c]=t.useState(!1),[m,g]=t.useState(2),[h,x]=t.useState(null),[p,u]=t.useState("smooth"),f=t.useRef(null),b=t.useRef(null);return{selectedFile:e,imagePreview:a,rgbMatrix:i,error:n,isProcessing:d,smoothingFactor:m,smoothedMatrix:h,processingMode:p,fileInputRef:f,canvasRef:b,setSelectedFile:r,setImagePreview:o,setRgbMatrix:s,setIsProcessing:c,setSmoothingFactor:g,setSmoothedMatrix:x,setProcessingMode:u,clearAll:()=>{r(null),o(null),s(""),x(null),l(""),f.current&&(f.current.value=""),b.current&&b.current.getContext("2d").clearRect(0,0,b.current.width,b.current.height)},setErrorState:e=>{l(e)},clearError:()=>{l("")}}})(),{processImage:H,renderSmoothedImage:C,smoothMatrix:z,spreadMatrix:D}=(()=>{const e=e=>{const t=document.createElement("canvas"),r=t.getContext("2d");t.width=e.width,t.height=e.height,r.drawImage(e,0,0);const{data:a,width:o,height:i}=r.getImageData(0,0,t.width,t.height),s=[];for(let n=0;n<i;n++){const e=[];for(let t=0;t<o;t++){const r=4*(n*o+t),i=a[r],s=a[r+1],l=a[r+2];e.push([i,s,l])}s.push(e)}return s},t=(e,t)=>{const r=[],a=e.length,o=e[0].length;for(let i=0;i<a;i++){const s=[];for(let r=0;r<o;r++){const n=Math.max(0,r-t),l=Math.min(o-1,r+t),d=Math.max(0,i-t),c=Math.min(a-1,i+t);let m=0,g=0,h=0,x=0;for(let t=d;t<=c;t++)for(let r=n;r<=l;r++){const[a,o,i]=e[t][r];m+=a,g+=o,h+=i,x++}s.push([Math.round(m/x),Math.round(g/x),Math.round(h/x)])}r.push(s)}return r},r=(e,t=1)=>{const r=e.length,a=e[0].length,o=Array.from({length:r},()=>Array.from({length:a},()=>[0,0,0])),i=Array.from({length:r},()=>Array.from({length:a},()=>!1));for(let s=0;s<r;s+=t)for(let n=0;n<a;n+=t){const[l,d,c]=e[s][n],m=Math.max(0,n-t),g=Math.min(a-1,n+t),h=Math.max(0,s-t),x=Math.min(r-1,s+t);for(let e=h;e<=x;e++)for(let t=m;t<=g;t++)i[e][t]||(o[e][t]=[l,d,c],i[e][t]=!0)}return o};return{imageToRGBMatrix:e,smoothMatrix:t,spreadMatrix:r,renderSmoothedImage:(e,t)=>{if(!e||!t.current)return;const r=t.current.getContext("2d"),a=e.length,o=e[0].length;t.current.width=o,t.current.height=a;const i=r.createImageData(o,a),s=i.data;let n=0;for(let l=0;l<a;l++)for(let t=0;t<o;t++){const[r,a,o]=e[l][t];s[n++]=r,s[n++]=a,s[n++]=o,s[n++]=255}r.putImageData(i,0,0)},processImage:async(a,o,i="smooth")=>new Promise((s,n)=>{const l=new Image;l.onload=()=>{try{const a=e(l),n="spread"===i?r(a,o):t(a,o),d=JSON.stringify(a,null,2);s({matrix:a,matrixString:d,processed:n})}catch(a){n(a)}},l.onerror=()=>{n(new Error("Error loading image"))},l.src=a})}})();t.useEffect(()=>{y&&R.current&&C(y,R)},[y,C,R]);return e.jsxs(o,{children:[e.jsx(i,{htmlFor:"image-upload",children:"Choose Image File"}),e.jsx(s,{id:"image-upload",type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void T("Please select a valid image file");W(),S(t),A(""),k(null);const r=new FileReader;r.onload=e=>{M(e.target.result)},r.readAsDataURL(t)},ref:_,"aria-label":"Upload image file"}),e.jsxs(f,{children:[e.jsx(b,{htmlFor:"processing-mode",children:"Processing Mode"}),e.jsxs(w,{id:"processing-mode",value:I,onChange:e=>{const t=e.target.value;if(Y(t),F)try{const e=JSON.parse(F),r="spread"===t?D(e,v):z(e,v);k(r)}catch(r){}},"aria-label":"Select processing mode",children:[e.jsx("option",{value:"smooth",children:"Smooth Matrix"}),e.jsx("option",{value:"spread",children:"Spread Matrix"})]})]}),a&&e.jsxs(g,{children:[e.jsxs(n,{children:[e.jsx("h3",{children:"Original Image"}),e.jsx(l,{src:a,alt:"Image preview","aria-label":"Image preview",loading:"lazy"})]}),y&&e.jsxs(n,{children:[e.jsxs("h3",{children:["spread"===I?"Spread":"Smoothed"," ","Image (Radius: ",v,")"]}),e.jsx(h,{children:e.jsx("canvas",{ref:R,"aria-label":("spread"===I?"Spread":"Smoothed")+" image canvas"})})]})]}),j&&e.jsx(m,{role:"alert","aria-live":"polite",children:j}),y&&e.jsxs(x,{children:[e.jsxs(p,{htmlFor:"smoothing-slider",children:["spread"===I?"Spread":"Smoothing"," ","Radius: ",v]}),e.jsx(u,{id:"smoothing-slider",type:"range",min:"1",max:"10",value:v,onChange:e=>{const t=parseInt(e.target.value);if(G(t),F)try{const e=JSON.parse(F),r="spread"===I?D(e,t):z(e,t);k(r)}catch(r){}},"aria-label":`Adjust ${"spread"===I?"spread":"smoothing"} radius`})]}),e.jsxs(d,{children:[e.jsx(c,{onClick:async()=>{if(r){E(!0),W();try{const{matrixString:e,processed:t}=await H(a,v,I);A(e),k(t)}catch(e){T("Error processing image. Please try again.")}finally{E(!1)}}else T("Please select an image file first")},disabled:!r||B,"aria-label":"Process image to RGB matrix",children:B?"Processing...":"Process Image"}),e.jsx(c,{onClick:P,disabled:!r&&!F,"aria-label":"Clear all data",children:"Clear"})]})]})};export{F as default};
