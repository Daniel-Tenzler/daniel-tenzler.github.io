import{c as e,j as r}from"./emotion-styled-base.browser.esm.-xjhUz6l.js";import{r as t}from"./index.CxjelfC8.js";const a=e("div",{target:"e19jlw9d17"})({name:"1i0tsdi",styles:"width:90%;max-width:1600px;height:100%;min-height:calc(100vh - 205px);margin:0 auto;padding:1.5em 0;display:flex;flex-direction:column;align-items:center;gap:1.5em"}),o=e("label",{target:"e19jlw9d16"})({name:"lfpq2x",styles:"color:var(--color-text-muted);font-size:1.1rem;font-weight:500;cursor:pointer;padding:0.75em 2em;border:2px solid var(--gray-383838);border-radius:8px;background-color:var(--gray-474747);transition:all 0.2s ease;display:inline-block;text-align:center;min-width:200px;&:hover{background-color:var(--gray-383838);border-color:var(--color-text-muted);}&:focus-within{outline:2px solid var(--color-text-muted);outline-offset:2px;}@media (max-width: 480px){font-size:1rem;padding:0.6em 1.5em;min-width:150px;}"}),i=e("input",{target:"e19jlw9d15"})({name:"eivff4",styles:"display:none"}),s=e("div",{target:"e19jlw9d14"})({name:"1vq371o",styles:"display:flex;justify-content:center;align-items:center;flex-direction:column;max-width:100%;margin:1em 0"}),n=e("img",{target:"e19jlw9d13"})({name:"1cyy336",styles:"max-width:100%;max-height:300px;border-radius:8px;border:2px solid var(--gray-383838);box-shadow:0 4px 8px #00000033;@media (max-width: 768px){max-height:200px;}"}),l=e("div",{target:"e19jlw9d12"})({name:"1y46tv2",styles:"display:flex;justify-content:center;align-items:center;gap:1.5em;flex-wrap:wrap;@media (max-width: 480px){gap:1em;}"}),d=e(e("button",{target:"e19jlw9d11"})({name:"1se1lvz",styles:"color:var(--color-text-muted);padding:0.75em 2em;border:none;border-radius:8px;background-color:var(--gray-2d2d2d);font-weight:500;font-size:0.95rem;cursor:pointer;min-width:140px;transition:background-color 0.2s ease,box-shadow 0.2s ease;&:hover:not(:disabled){background-color:var(--gray-222939);box-shadow:0 2px 4px #0000001a;}&:active:not(:disabled){background-color:var(--gray-383838);box-shadow:none;}&:focus-visible{outline:2px solid var(--gray-222939);outline-offset:2px;}&:disabled{opacity:0.5;cursor:not-allowed;}@media (max-width: 480px){padding:0.6em 1.5em;font-size:0.9rem;min-width:120px;}"}),{target:"e19jlw9d10"})(""),c=e("div",{target:"e19jlw9d8"})({name:"h69x97",styles:"color:#ff6b6b;background-color:rgba(255, 107, 107, 0.1);border:1px solid rgba(255, 107, 107, 0.3);border-radius:6px;padding:0.75em 1em;margin:0.5em auto;text-align:center;font-size:0.9rem;max-width:90%"}),m=e("div",{target:"e19jlw9d7"})({name:"1cb0n2x",styles:"display:flex;flex-direction:column;gap:2em;width:100%;max-width:1500px;@media (min-width: 768px){flex-direction:row;justify-content:space-around;align-items:flex-start;}"}),g=e("div",{target:"e19jlw9d6"})({name:"1i850zy",styles:"display:flex;justify-content:center;align-items:center;max-width:100%;canvas{max-width:100%;max-height:300px;border-radius:8px;border:2px solid var(--gray-383838);box-shadow:0 4px 8px #00000033;@media (max-width: 768px){max-height:200px;}}"}),x=e("div",{target:"e19jlw9d5"})({name:"1jwby9t",styles:"display:flex;flex-direction:column;align-items:center;gap:1em;padding:1em;background-color:var(--gray-474747);border-radius:8px;border:1px solid var(--gray-383838);max-width:400px;margin-left:auto;margin-right:auto"}),h=e("label",{target:"e19jlw9d4"})({name:"p4ls6k",styles:"color:var(--color-text-muted);font-size:1rem;font-weight:500;text-align:center"}),p=e("input",{target:"e19jlw9d3"})({name:"kr3e0o",styles:"width:100%;height:6px;border-radius:3px;background:var(--gray-383838);outline:none;cursor:pointer;&::-webkit-slider-thumb{appearance:none;width:20px;height:20px;border-radius:50%;background:var(--color-text-muted);cursor:pointer;border:2px solid var(--gray-383838);transition:all 0.2s ease;&:hover{background:var(--color-text-emphasis);transform:scale(1.1);}}&::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:var(--color-text-muted);cursor:pointer;border:2px solid var(--gray-383838);transition:all 0.2s ease;&:hover{background:var(--color-text-emphasis);transform:scale(1.1);}}&:focus-visible{outline:2px solid var(--color-text-muted);outline-offset:2px;}"}),u=e("div",{target:"e19jlw9d2"})({name:"1jwby9t",styles:"display:flex;flex-direction:column;align-items:center;gap:1em;padding:1em;background-color:var(--gray-474747);border-radius:8px;border:1px solid var(--gray-383838);max-width:400px;margin-left:auto;margin-right:auto"}),f=e("label",{target:"e19jlw9d1"})({name:"p4ls6k",styles:"color:var(--color-text-muted);font-size:1rem;font-weight:500;text-align:center"}),b=e("select",{target:"e19jlw9d0"})({name:"v2n877",styles:"background-color:var(--gray-383838);color:var(--color-text-muted);border:2px solid var(--gray-383838);border-radius:6px;padding:0.5em 1em;font-size:0.95rem;cursor:pointer;min-width:200px;transition:all 0.2s ease;&:hover{border-color:var(--color-text-muted);}&:focus-visible{outline:2px solid var(--color-text-muted);outline-offset:2px;border-color:var(--color-text-muted);}option{background-color:var(--gray-383838);color:var(--color-text-muted);}"}),v=()=>{const{selectedFile:e,imagePreview:v,rgbMatrix:w,error:y,isProcessing:j,smoothingFactor:S,smoothedMatrix:M,processingMode:k,fileInputRef:I,canvasRef:P,setSelectedFile:R,setImagePreview:F,setRgbMatrix:z,setIsProcessing:C,setSmoothingFactor:E,setSmoothedMatrix:A,setProcessingMode:D,clearAll:O,setErrorState:J,clearError:N}=(()=>{const[e,r]=t.useState(null),[a,o]=t.useState(null),[i,s]=t.useState(""),[n,l]=t.useState(""),[d,c]=t.useState(!1),[m,g]=t.useState(2),[x,h]=t.useState(null),[p,u]=t.useState("smooth"),f=t.useRef(null),b=t.useRef(null);return{selectedFile:e,imagePreview:a,rgbMatrix:i,error:n,isProcessing:d,smoothingFactor:m,smoothedMatrix:x,processingMode:p,fileInputRef:f,canvasRef:b,setSelectedFile:r,setImagePreview:o,setRgbMatrix:s,setIsProcessing:c,setSmoothingFactor:g,setSmoothedMatrix:h,setProcessingMode:u,clearAll:()=>{r(null),o(null),s(""),h(null),l(""),f.current&&(f.current.value=""),b.current&&b.current.getContext("2d").clearRect(0,0,b.current.width,b.current.height)},setErrorState:e=>{l(e)},clearError:()=>{l("")}}})(),{processImage:q,renderSmoothedImage:B,smoothMatrix:G,spreadMatrix:U}=(()=>{const e=e=>{const r=document.createElement("canvas"),t=r.getContext("2d");r.width=e.width,r.height=e.height,t.drawImage(e,0,0);const{data:a,width:o,height:i}=t.getImageData(0,0,r.width,r.height),s=[];for(let n=0;n<i;n++){const e=[];for(let r=0;r<o;r++){const t=4*(n*o+r),i=a[t],s=a[t+1],l=a[t+2];e.push([i,s,l])}s.push(e)}return s},r=(e,r)=>{const t=[],a=e.length,o=e[0].length;for(let i=0;i<a;i++){const s=[];for(let t=0;t<o;t++){const n=Math.max(0,t-r),l=Math.min(o-1,t+r),d=Math.max(0,i-r),c=Math.min(a-1,i+r);let m=0,g=0,x=0,h=0;for(let r=d;r<=c;r++)for(let t=n;t<=l;t++){const[a,o,i]=e[r][t];m+=a,g+=o,x+=i,h++}s.push([Math.round(m/h),Math.round(g/h),Math.round(x/h)])}t.push(s)}return t},t=(e,r=1)=>{const t=e.length,a=e[0].length,o=Array.from({length:t},()=>Array.from({length:a},()=>[0,0,0])),i=Array.from({length:t},()=>Array.from({length:a},()=>!1));for(let s=0;s<t;s+=r)for(let n=0;n<a;n+=r){const[l,d,c]=e[s][n],m=Math.max(0,n-r),g=Math.min(a-1,n+r),x=Math.max(0,s-r),h=Math.min(t-1,s+r);for(let e=x;e<=h;e++)for(let r=m;r<=g;r++)i[e][r]||(o[e][r]=[l,d,c],i[e][r]=!0)}return o};return{imageToRGBMatrix:e,smoothMatrix:r,spreadMatrix:t,renderSmoothedImage:(e,r)=>{if(!e||!r.current)return;const t=r.current.getContext("2d"),a=e.length,o=e[0].length;r.current.width=o,r.current.height=a;const i=t.createImageData(o,a),s=i.data;let n=0;for(let l=0;l<a;l++)for(let r=0;r<o;r++){const[t,a,o]=e[l][r];s[n++]=t,s[n++]=a,s[n++]=o,s[n++]=255}t.putImageData(i,0,0)},processImage:async(a,o,i="smooth")=>new Promise((s,n)=>{const l=new Image;l.onload=()=>{try{const a=e(l),n="spread"===i?t(a,o):r(a,o),d=JSON.stringify(a,null,2);s({matrix:a,matrixString:d,processed:n})}catch(a){n(a)}},l.onerror=()=>{n(new Error("Error loading image"))},l.src=a})}})();t.useEffect(()=>{M&&P.current&&B(M,P)},[M,B,P]);return r.jsxs(a,{children:[r.jsx(o,{htmlFor:"image-upload",children:"Choose Image File"}),r.jsx(i,{id:"image-upload",type:"file",accept:"image/*",onChange:e=>{const r=e.target.files[0];if(!r)return;if(!r.type.startsWith("image/"))return void J("Please select a valid image file");N(),R(r),z(""),A(null);const t=new FileReader;t.onload=e=>{F(e.target.result)},t.readAsDataURL(r)},ref:I,"aria-label":"Upload image file"}),r.jsxs(u,{children:[r.jsx(f,{htmlFor:"processing-mode",children:"Processing Mode"}),r.jsxs(b,{id:"processing-mode",value:k,onChange:e=>{const r=e.target.value;if(D(r),w)try{const e=JSON.parse(w),t="spread"===r?U(e,S):G(e,S);A(t)}catch(t){}},"aria-label":"Select processing mode",children:[r.jsx("option",{value:"smooth",children:"Smooth Matrix"}),r.jsx("option",{value:"spread",children:"Spread Matrix"})]})]}),v&&r.jsxs(m,{children:[r.jsxs(s,{children:[r.jsx("h3",{children:"Original Image"}),r.jsx(n,{src:v,alt:"Image preview","aria-label":"Image preview",loading:"lazy"})]}),M&&r.jsxs(s,{children:[r.jsxs("h3",{children:["spread"===k?"Spread":"Smoothed"," ","Image (Radius: ",S,")"]}),r.jsx(g,{children:r.jsx("canvas",{ref:P,"aria-label":("spread"===k?"Spread":"Smoothed")+" image canvas"})})]})]}),y&&r.jsx(c,{role:"alert","aria-live":"polite",children:y}),M&&r.jsxs(x,{children:[r.jsxs(h,{htmlFor:"smoothing-slider",children:["spread"===k?"Spread":"Smoothing"," ","Radius: ",S]}),r.jsx(p,{id:"smoothing-slider",type:"range",min:"1",max:"10",value:S,onChange:e=>{const r=parseInt(e.target.value);if(E(r),w)try{const e=JSON.parse(w),t="spread"===k?U(e,r):G(e,r);A(t)}catch(t){}},"aria-label":`Adjust ${"spread"===k?"spread":"smoothing"} radius`})]}),r.jsxs(l,{children:[r.jsx(d,{onClick:async()=>{if(e){C(!0),N();try{const{matrixString:e,processed:r}=await q(v,S,k);z(e),A(r)}catch(r){J("Error processing image. Please try again.")}finally{C(!1)}}else J("Please select an image file first")},disabled:!e||j,"aria-label":"Process image to RGB matrix",children:j?"Processing...":"Process Image"}),r.jsx(d,{onClick:O,disabled:!e&&!w,"aria-label":"Clear all data",children:"Clear"})]})]})};export{v as default};
