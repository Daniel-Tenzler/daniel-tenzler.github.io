import{j as a}from"./emotion-element-f0de968e.browser.esm.Bm6gAZbX.js";import{r as B}from"./index.DatCARk7.js";import{c as g}from"./emotion-styled-base.browser.esm.udlV9ZuP.js";import{C as e}from"./Colors.NoHyZRjE.js";const W=()=>{const[v,I]=B.useState(null),[j,M]=B.useState(null),[_,r]=B.useState(""),[t,o]=B.useState(""),[l,i]=B.useState(!1),[d,n]=B.useState(2),[s,c]=B.useState(null),[x,m]=B.useState("smooth"),u=B.useRef(null),h=B.useRef(null);return{selectedFile:v,imagePreview:j,rgbMatrix:_,error:t,isProcessing:l,smoothingFactor:d,smoothedMatrix:s,processingMode:x,fileInputRef:u,canvasRef:h,setSelectedFile:I,setImagePreview:M,setRgbMatrix:r,setIsProcessing:i,setSmoothingFactor:n,setSmoothedMatrix:c,setProcessingMode:m,clearAll:()=>{I(null),M(null),r(""),c(null),o(""),u.current&&(u.current.value=""),h.current&&h.current.getContext("2d").clearRect(0,0,h.current.width,h.current.height)},setErrorState:p=>{o(p)},clearError:()=>{o("")}}},H=()=>{const v=r=>{const t=document.createElement("canvas"),o=t.getContext("2d");t.width=r.width,t.height=r.height,o.drawImage(r,0,0);const{data:l,width:i,height:d}=o.getImageData(0,0,t.width,t.height),n=[];for(let s=0;s<d;s++){const c=[];for(let x=0;x<i;x++){const m=(s*i+x)*4,u=l[m],h=l[m+1],F=l[m+2];c.push([u,h,F])}n.push(c)}return n},I=(r,t)=>{const o=[],l=r.length,i=r[0].length;for(let d=0;d<l;d++){const n=[];for(let s=0;s<i;s++){const c=Math.max(0,s-t),x=Math.min(i-1,s+t),m=Math.max(0,d-t),u=Math.min(l-1,d+t);let h=0,F=0,S=0,f=0;for(let p=m;p<=u;p++)for(let R=c;R<=x;R++){const[P,A,C]=r[p][R];h+=P,F+=A,S+=C,f++}n.push([Math.round(h/f),Math.round(F/f),Math.round(S/f)])}o.push(n)}return o},j=(r,t=1)=>{const o=r.length,l=r[0].length,i=Array.from({length:o},()=>Array.from({length:l},()=>[0,0,0])),d=Array.from({length:o},()=>Array.from({length:l},()=>!1));for(let n=0;n<o;n+=t)for(let s=0;s<l;s+=t){const[c,x,m]=r[n][s],u=Math.max(0,s-t),h=Math.min(l-1,s+t),F=Math.max(0,n-t),S=Math.min(o-1,n+t);for(let f=F;f<=S;f++)for(let p=u;p<=h;p++)d[f][p]||(i[f][p]=[c,x,m],d[f][p]=!0)}return i};return{imageToRGBMatrix:v,smoothMatrix:I,spreadMatrix:j,renderSmoothedImage:(r,t)=>{if(!r||!t.current)return;const o=t.current.getContext("2d"),l=r.length,i=r[0].length;t.current.width=i,t.current.height=l;const d=o.createImageData(i,l),n=d.data;let s=0;for(let c=0;c<l;c++)for(let x=0;x<i;x++){const[m,u,h]=r[c][x];n[s++]=m,n[s++]=u,n[s++]=h,n[s++]=255}o.putImageData(d,0,0)},processImage:async(r,t,o="smooth")=>new Promise((l,i)=>{const d=new Image;d.onload=()=>{try{const n=v(d),s=o==="spread"?j(n,t):I(n,t),c=JSON.stringify(n,null,2);l({matrix:n,matrixString:c,processed:s})}catch(n){i(n)}},d.onerror=()=>{i(new Error("Error loading image"))},d.src=r})}},z=g("div",{target:"e19jlw9d17"})({name:"1i0tsdi",styles:"width:90%;max-width:1600px;height:100%;min-height:calc(100vh - 205px);margin:0 auto;padding:1.5em 0;display:flex;flex-direction:column;align-items:center;gap:1.5em"}),D=g("label",{target:"e19jlw9d16"})("color:",e.WHITE_BFBFBF,";font-size:1.1rem;font-weight:500;cursor:pointer;padding:0.75em 2em;border:2px solid ",e.GRAY_383838,";border-radius:8px;background-color:",e.GRAY_474747,";transition:all 0.2s ease;display:inline-block;text-align:center;min-width:200px;&:hover{background-color:",e.GRAY_383838,";border-color:",e.WHITE_BFBFBF,";}&:focus-within{outline:2px solid ",e.WHITE_BFBFBF,";outline-offset:2px;}@media (max-width: 480px){font-size:1rem;padding:0.6em 1.5em;min-width:150px;}"),O=g("input",{target:"e19jlw9d15"})({name:"eivff4",styles:"display:none"}),Y=g("div",{target:"e19jlw9d14"})({name:"1vq371o",styles:"display:flex;justify-content:center;align-items:center;flex-direction:column;max-width:100%;margin:1em 0"}),L=g("img",{target:"e19jlw9d13"})("max-width:100%;max-height:300px;border-radius:8px;border:2px solid ",e.GRAY_383838,";box-shadow:0 4px 8px rgba(0, 0, 0, 0.2);@media (max-width: 768px){max-height:200px;}"),X=g("div",{target:"e19jlw9d12"})({name:"1y46tv2",styles:"display:flex;justify-content:center;align-items:center;gap:1.5em;flex-wrap:wrap;@media (max-width: 480px){gap:1em;}"}),J=g("button",{target:"e19jlw9d11"})("color:",e.WHITE_BFBFBF,";padding:0.75em 2em;border:none;border-radius:8px;background-color:",e.GRAY_2D2D2D,";font-weight:500;font-size:0.95rem;cursor:pointer;min-width:140px;transition:background-color 0.2s ease,box-shadow 0.2s ease;&:hover:not(:disabled){background-color:",e.GRAY_222939,";box-shadow:0 2px 4px rgba(0, 0, 0, 0.1);}&:active:not(:disabled){background-color:",e.GRAY_383838,";box-shadow:none;}&:focus-visible{outline:2px solid ",e.GRAY_222939,";outline-offset:2px;}&:disabled{opacity:0.5;cursor:not-allowed;}@media (max-width: 480px){padding:0.6em 1.5em;font-size:0.9rem;min-width:120px;}"),G=g(J,{target:"e19jlw9d10"})(""),N=g("div",{target:"e19jlw9d8"})({name:"h69x97",styles:"color:#ff6b6b;background-color:rgba(255, 107, 107, 0.1);border:1px solid rgba(255, 107, 107, 0.3);border-radius:6px;padding:0.75em 1em;margin:0.5em auto;text-align:center;font-size:0.9rem;max-width:90%"}),U=g("div",{target:"e19jlw9d7"})({name:"1cb0n2x",styles:"display:flex;flex-direction:column;gap:2em;width:100%;max-width:1500px;@media (min-width: 768px){flex-direction:row;justify-content:space-around;align-items:flex-start;}"}),$=g("div",{target:"e19jlw9d6"})("display:flex;justify-content:center;align-items:center;max-width:100%;canvas{max-width:100%;max-height:300px;border-radius:8px;border:2px solid ",e.GRAY_383838,";box-shadow:0 4px 8px rgba(0, 0, 0, 0.2);@media (max-width: 768px){max-height:200px;}}"),q=g("div",{target:"e19jlw9d5"})("display:flex;flex-direction:column;align-items:center;gap:1em;padding:1em;background-color:",e.GRAY_474747,";border-radius:8px;border:1px solid ",e.GRAY_383838,";max-width:400px;margin-left:auto;margin-right:auto;"),K=g("label",{target:"e19jlw9d4"})("color:",e.WHITE_BFBFBF,";font-size:1rem;font-weight:500;text-align:center;"),Q=g("input",{target:"e19jlw9d3"})("width:100%;height:6px;border-radius:3px;background:",e.GRAY_383838,";outline:none;cursor:pointer;&::-webkit-slider-thumb{appearance:none;width:20px;height:20px;border-radius:50%;background:",e.WHITE_BFBFBF,";cursor:pointer;border:2px solid ",e.GRAY_383838,";transition:all 0.2s ease;&:hover{background:",e.WHITE_FFFFFF,";transform:scale(1.1);}}&::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:",e.WHITE_BFBFBF,";cursor:pointer;border:2px solid ",e.GRAY_383838,";transition:all 0.2s ease;&:hover{background:",e.WHITE_FFFFFF,";transform:scale(1.1);}}&:focus-visible{outline:2px solid ",e.WHITE_BFBFBF,";outline-offset:2px;}"),V=g("div",{target:"e19jlw9d2"})("display:flex;flex-direction:column;align-items:center;gap:1em;padding:1em;background-color:",e.GRAY_474747,";border-radius:8px;border:1px solid ",e.GRAY_383838,";max-width:400px;margin-left:auto;margin-right:auto;"),Z=g("label",{target:"e19jlw9d1"})("color:",e.WHITE_BFBFBF,";font-size:1rem;font-weight:500;text-align:center;"),ee=g("select",{target:"e19jlw9d0"})("background-color:",e.GRAY_383838,";color:",e.WHITE_BFBFBF,";border:2px solid ",e.GRAY_383838,";border-radius:6px;padding:0.5em 1em;font-size:0.95rem;cursor:pointer;min-width:200px;transition:all 0.2s ease;&:hover{border-color:",e.WHITE_BFBFBF,";}&:focus-visible{outline:2px solid ",e.WHITE_BFBFBF,";outline-offset:2px;border-color:",e.WHITE_BFBFBF,";}option{background-color:",e.GRAY_383838,";color:",e.WHITE_BFBFBF,";}"),se=()=>{const{selectedFile:v,imagePreview:I,rgbMatrix:j,error:M,isProcessing:_,smoothingFactor:r,smoothedMatrix:t,processingMode:o,fileInputRef:l,canvasRef:i,setSelectedFile:d,setImagePreview:n,setRgbMatrix:s,setIsProcessing:c,setSmoothingFactor:x,setSmoothedMatrix:m,setProcessingMode:u,clearAll:h,setErrorState:F,clearError:S}=W(),{processImage:f,renderSmoothedImage:p,smoothMatrix:R,spreadMatrix:P}=H();B.useEffect(()=>{t&&i.current&&p(t,i)},[t,p,i]);const A=y=>{const b=y.target.files[0];if(!b)return;if(!b.type.startsWith("image/")){F("Please select a valid image file");return}S(),d(b),s(""),m(null);const w=new FileReader;w.onload=E=>{n(E.target.result)},w.readAsDataURL(b)},C=async()=>{if(!v){F("Please select an image file first");return}c(!0),S();try{const{matrixString:y,processed:b}=await f(I,r,o);s(y),m(b)}catch(y){console.error("Error processing image:",y),F("Error processing image. Please try again.")}finally{c(!1)}},k=y=>{const b=parseInt(y.target.value);if(x(b),j)try{const w=JSON.parse(j),E=o==="spread"?P(w,b):R(w,b);m(E)}catch(w){console.error("Error updating smoothing:",w)}},T=y=>{const b=y.target.value;if(u(b),j)try{const w=JSON.parse(j),E=b==="spread"?P(w,r):R(w,r);m(E)}catch(w){console.error("Error updating processing mode:",w)}};return a.jsxs(z,{children:[a.jsx(D,{htmlFor:"image-upload",children:"Choose Image File"}),a.jsx(O,{id:"image-upload",type:"file",accept:"image/*",onChange:A,ref:l,"aria-label":"Upload image file"}),a.jsxs(V,{children:[a.jsx(Z,{htmlFor:"processing-mode",children:"Processing Mode"}),a.jsxs(ee,{id:"processing-mode",value:o,onChange:T,"aria-label":"Select processing mode",children:[a.jsx("option",{value:"smooth",children:"Smooth Matrix"}),a.jsx("option",{value:"spread",children:"Spread Matrix"})]})]}),I&&a.jsxs(U,{children:[a.jsxs(Y,{children:[a.jsx("h3",{children:"Original Image"}),a.jsx(L,{src:I,alt:"Image preview","aria-label":"Image preview"})]}),t&&a.jsxs(Y,{children:[a.jsxs("h3",{children:[o==="spread"?"Spread":"Smoothed"," Image (Radius: ",r,")"]}),a.jsx($,{children:a.jsx("canvas",{ref:i,"aria-label":`${o==="spread"?"Spread":"Smoothed"} image canvas`})})]})]}),M&&a.jsx(N,{role:"alert","aria-live":"polite",children:M}),t&&a.jsxs(q,{children:[a.jsxs(K,{htmlFor:"smoothing-slider",children:[o==="spread"?"Spread":"Smoothing"," Radius:"," ",r]}),a.jsx(Q,{id:"smoothing-slider",type:"range",min:"1",max:"10",value:r,onChange:k,"aria-label":`Adjust ${o==="spread"?"spread":"smoothing"} radius`})]}),a.jsxs(X,{children:[a.jsx(G,{onClick:C,disabled:!v||_,"aria-label":"Process image to RGB matrix",children:_?"Processing...":"Process Image"}),a.jsx(G,{onClick:h,disabled:!v&&!j,"aria-label":"Clear all data",children:"Clear"})]})]})};export{se as default};
